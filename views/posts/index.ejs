<%- include('../partials/header') %>

<h1>Chirps!</h1>

<% posts.forEach(function(p) { %>
    <div class='user-post'>
        <table class='user-post-table'>
            <td class='user-avatar-td'><img class='user-avatar' alt='avatar' src='<%= p.userAvatar %>' referrerpolicy='no-referrer'></td>
            <td class='username'><%= p.userName %></td>
            <td><%= p.content %></td>
            <td class='drop-down-btn'>
                <% if (user?._id.equals(p.user)) { %>
                    <div id='dropdown'>
                        <form action='/posts/<%= p._id %>?_method=DELETE' method='POST'>
                            <button type='submit'><span class="material-symbols-outlined">
                                delete
                            </span></button>
                        </form>
                        <form action='/posts/<%= p._id %>?_method=PUT' method='POST'>
                            <input id='edit-input' type='text' name='content' value='<%= p.content %>'>
                            <button id='edit-btn' type='submit'><span class="material-symbols-outlined">
                                edit
                            </span></button>
                        </form>
                    </div>
                    <button id='dropdownbtn'>
                        <span id='openMenu' class="material-symbols-outlined">more_vert</span>
                        <span id='closeMenu' class="material-symbols-outlined">arrow_back_ios_new</span>
                    </button>
                </td>
                <% } %>
        </table>
    </div>
<% }); %>

<script>
    document.addEventListener('click', function(e) {
        if (e.target.id === 'dropdownbtn' || e.target.id === 'openMenu' || e.target.id === 'closeMenu') {
            console.log(e.target);
            document.getElementById('dropdown').style.visibility='visible';
        } if (e.target.id === 'edit-btn') {

        }
        console.log(e.target);
    })
</script>

<%- include('../partials/footer') %>